# 需求文档

## 介绍

当前 MCP 工具中存在条件必需参数描述不够清晰的问题：某些参数在特定条件下是必需的，但参数描述不够明确，导致 AI 在调用工具时可能不提供必需参数。例如，`getFunctionList` 工具中，当 `action=detail` 时，`name` 参数是必需的，但当前描述为"函数名称（detail 操作时必需）"，可能不够突出和清晰。

对比 `queryCloudRun` 工具的描述方式："要查询详细信息的服务名称。当action为detail时必需提供，必须是已存在的服务名称。可通过list操作获取可用的服务名称列表"，这种描述方式更加明确和详细。

本需求旨在改进 MCP 工具的参数描述，使条件必需参数的要求更加清晰明确，帮助 AI 正确理解和使用工具。

## 需求

### 需求 1 - 改进条件必需参数的描述清晰度

**用户故事：** 作为 AI，我希望 MCP 工具的参数描述能够清晰地说明条件必需性，这样我就能在调用工具时提供正确的参数，避免运行时错误。

#### 验收标准

1. When `getFunctionList` 工具的 `name` 参数描述时，the 描述文本 shall 明确说明："要查询的函数名称。当 action='detail' 时，此参数为必填项，必须提供已存在的函数名称。可通过 action='list' 操作获取可用的函数名称列表"。

2. When `getFunctionList` 工具的整体 description 时，the 描述文本 shall 明确说明："获取云函数列表或单个函数详情。通过 action 参数区分操作类型：list=获取函数列表（默认），detail=获取函数详情（需要提供 name 参数）"。

3. When 其他 MCP 工具存在类似的条件必需参数时（如 `dataModel` 工具的 `get` 操作需要 `name` 参数），the 参数描述 shall 遵循相同的清晰度标准，明确说明参数的作用、何时必需、如何获取值等信息。

4. When 参数描述包含条件必需性时，the 描述文本 shall 使用明确的措辞，如"当...时必需提供"、"当...时此参数为必填项"等，避免使用可能被忽略的简短说明。

### 需求 2 - 统一的参数描述规范

**用户故事：** 作为项目维护者，我希望所有 MCP 工具使用统一的参数描述规范，这样代码更易维护，新工具开发时也能遵循一致的规范。

#### 验收标准

1. When 定义新的 MCP 工具时，the 开发团队 shall 遵循统一的参数描述规范，特别是对于条件必需参数。

2. When 描述条件必需参数时，the 描述文本 shall 包含以下要素：
   - 参数的作用和用途
   - 何时必需（明确说明触发条件）
   - 如何获取或确定参数值（如适用）
   - 参数值的格式要求（如适用）

3. When 查看工具定义时，the 开发者或 AI shall 能够清楚地从描述中理解哪些参数在什么条件下是必需的，无需查看代码实现。

### 需求 3 - 向后兼容性

**用户故事：** 作为现有用户，我希望参数描述的改进不会破坏现有的工具调用，确保现有代码和 AI 调用仍然能够正常工作。

#### 验收标准

1. When 调用 `getFunctionList` 工具且 `action` 为 `"list"` 时，the MCP 工具系统 shall 保持与现有行为完全一致，不要求提供 `name` 参数。

2. When 调用 `getFunctionList` 工具且 `action` 为 `"detail"` 并提供 `name` 参数时，the MCP 工具系统 shall 保持与现有行为完全一致。

3. When 参数描述改进后，the 现有的工具调用示例和文档 shall 仍然有效，只是描述更加清晰。

4. When 改进参数描述时，the 代码逻辑和运行时验证 shall 保持不变，仅改进描述文本。

### 需求 4 - 工具整体描述改进

**用户故事：** 作为 AI，我希望工具的整体描述能够清楚地说明不同操作类型的要求，这样我就能在调用前了解需要提供哪些参数。

#### 验收标准

1. When `getFunctionList` 工具的整体 description 时，the 描述文本 shall 明确说明不同 action 值的参数要求，例如："获取云函数列表或单个函数详情。通过 action 参数区分操作类型：list=获取函数列表（默认，无需额外参数），detail=获取函数详情（需要提供 name 参数指定函数名称）"。

2. When 其他具有条件必需参数的 MCP 工具时，the 工具整体描述 shall 遵循相同的清晰度标准，明确说明不同操作类型的参数要求。

3. When AI 查看工具定义时，the 工具描述和参数描述 together shall 提供足够的信息，使 AI 能够正确理解如何调用工具。
